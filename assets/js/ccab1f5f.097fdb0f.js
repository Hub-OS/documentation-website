"use strict";(globalThis.webpackChunkdocumentation=globalThis.webpackChunkdocumentation||[]).push([[5044],{6588:(e,n,d)=>{d.r(n),d.d(n,{assets:()=>c,contentTitle:()=>t,default:()=>f,frontMatter:()=>r,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"client/lua-api/defense-api/defense-rule","title":"DefenseRule","description":"See living:adddefenserule()","source":"@site/docs/01-client/04-lua-api/06-defense-api/01-defense-rule.md","sourceDirName":"01-client/04-lua-api/06-defense-api","slug":"/client/lua-api/defense-api/defense-rule","permalink":"/client/lua-api/defense-api/defense-rule","draft":false,"unlisted":false,"editUrl":"https://github.com/Hub-OS/documentation-website/tree/master/docs/01-client/04-lua-api/06-defense-api/01-defense-rule.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{},"sidebar":"clientSidebar","previous":{"title":"TurnGauge","permalink":"/client/lua-api/attack-api/turn-gauge"},"next":{"title":"IntangibleRule","permalink":"/client/lua-api/defense-api/intangible-rule"}}');var s=d(4848),l=d(8453);const r={},t="DefenseRule",c={},a=[{value:"<code>DefenseRule.new(defense_priority, defense_order)</code>",id:"defenserulenewdefense_priority-defense_order",level:3},{value:"<code>defense_rule:replaced()</code>",id:"defense_rulereplaced",level:3},{value:"<code>defense_rule.on_replace_func = function()</code>",id:"defense_ruleon_replace_func--function",level:3},{value:"<code>defense_rule.defense_func = function(defense, attacker?, defender, hit_props)</code>",id:"defense_ruledefense_func--functiondefense-attacker-defender-hit_props",level:3},{value:"<code>defense_rule.filter_func = function(hit_props): HitProps</code>",id:"defense_rulefilter_func--functionhit_props-hitprops",level:3},{value:"Defense",id:"defense",level:2},{value:"<code>defense:block_damage()</code>",id:"defenseblock_damage",level:3},{value:"<code>defense:damage_blocked()</code>",id:"defensedamage_blocked",level:3},{value:"<code>defense:set_responded()</code>",id:"defenseset_responded",level:3},{value:"<code>defense:responded()</code>",id:"defenseresponded",level:3}];function o(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",ul:"ul",...(0,l.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"defenserule",children:"DefenseRule"})}),"\n",(0,s.jsxs)(n.p,{children:["See ",(0,s.jsxs)(n.a,{href:"/client/lua-api/entity-api/living#livingadd_defense_ruledefense_rule",children:["living",":add_defense_rule","()"]})]}),"\n",(0,s.jsx)(n.h3,{id:"defenserulenewdefense_priority-defense_order",children:(0,s.jsx)(n.code,{children:"DefenseRule.new(defense_priority, defense_order)"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"priority"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"DefensePriority.Barrier"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"DefensePriority.Action"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"DefensePriority.Body"})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"DefensePriority.Trap"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Additionally causes all players to see ",(0,s.jsx)(n.code,{children:"????"})," in the UI"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"DefensePriority.Last"})}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"defense_order"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"DefenseOrder.Always"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"DefenseOrder.CollisionOnly"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Adding a DefenseRule to an entity when a DefenseRule already exists with the same priorty will replace the existing rule."}),"\n",(0,s.jsx)(n.p,{children:"Returns a new DefenseRule."}),"\n",(0,s.jsx)(n.h3,{id:"defense_rulereplaced",children:(0,s.jsx)(n.code,{children:"defense_rule:replaced()"})}),"\n",(0,s.jsx)(n.p,{children:"Returns true if a DefenseRule with the same priority replaced this rule."}),"\n",(0,s.jsx)(n.h3,{id:"defense_ruleon_replace_func--function",children:(0,s.jsx)(n.code,{children:"defense_rule.on_replace_func = function()"})}),"\n",(0,s.jsx)(n.p,{children:"Called when a DefenseRule with the same priority replaced this rule."}),"\n",(0,s.jsx)(n.h3,{id:"defense_ruledefense_func--functiondefense-attacker-defender-hit_props",children:(0,s.jsx)(n.code,{children:"defense_rule.defense_func = function(defense, attacker?, defender, hit_props)"})}),"\n",(0,s.jsxs)(n.p,{children:["If the defense order is ",(0,s.jsx)(n.code,{children:"DefenseOrder.Always"}),", this function will be called on every hit."]}),"\n",(0,s.jsxs)(n.p,{children:["If the defense order is ",(0,s.jsx)(n.code,{children:"DefenseOrder.CollisionOnly"}),", this function will be called after intangibility is determined to not block the attack."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"defense"}),": ",(0,s.jsx)(n.a,{href:"#defense",children:"Defense"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"attacker"}),": ",(0,s.jsx)(n.a,{href:"/client/lua-api/entity-api/entity",children:"Entity"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"defender"}),": ",(0,s.jsx)(n.a,{href:"/client/lua-api/entity-api/entity",children:"Entity"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"hit_props"}),": ",(0,s.jsx)(n.a,{href:"/client/lua-api/attack-api/hit-props",children:"HitProps"})]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"defense_rulefilter_func--functionhit_props-hitprops",children:(0,s.jsx)(n.code,{children:"defense_rule.filter_func = function(hit_props): HitProps"})}),"\n",(0,s.jsx)(n.p,{children:"Called before applying damage and statuses to the entity."}),"\n",(0,s.jsxs)(n.p,{children:["Should return ",(0,s.jsx)(n.a,{href:"/client/lua-api/attack-api/hit-props",children:"HitProps"})]}),"\n",(0,s.jsx)(n.p,{children:"The return value replaces the HitProps applied to the entity."}),"\n",(0,s.jsx)(n.h2,{id:"defense",children:"Defense"}),"\n",(0,s.jsx)(n.p,{children:"Created for each attack resolution and passed through DefenseRule callbacks."}),"\n",(0,s.jsx)(n.h3,{id:"defenseblock_damage",children:(0,s.jsx)(n.code,{children:"defense:block_damage()"})}),"\n",(0,s.jsx)(n.p,{children:"Prevents damage and statuses from applying to the defending entity."}),"\n",(0,s.jsx)(n.h3,{id:"defensedamage_blocked",children:(0,s.jsx)(n.code,{children:"defense:damage_blocked()"})}),"\n",(0,s.jsxs)(n.p,{children:["Returns true if ",(0,s.jsx)(n.code,{children:"defense:block_damage()"})," was called."]}),"\n",(0,s.jsx)(n.h3,{id:"defenseset_responded",children:(0,s.jsx)(n.code,{children:"defense:set_responded()"})}),"\n",(0,s.jsx)(n.p,{children:"Used to track if the defense retaliated against a hit, such spawning an attack in Reflect / Shields."}),"\n",(0,s.jsx)(n.h3,{id:"defenseresponded",children:(0,s.jsx)(n.code,{children:"defense:responded()"})}),"\n",(0,s.jsxs)(n.p,{children:["Returns true if ",(0,s.jsx)(n.code,{children:"defense:set_responded()"})," was called for this hit."]}),"\n",(0,s.jsx)(n.p,{children:"Used to track if the defense retaliated against a hit, such spawning an attack in Reflect / Shields."})]})}function f(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}},8453:(e,n,d)=>{d.d(n,{R:()=>r,x:()=>t});var i=d(6540);const s={},l=i.createContext(s);function r(e){const n=i.useContext(l);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),i.createElement(l.Provider,{value:n},e.children)}}}]);