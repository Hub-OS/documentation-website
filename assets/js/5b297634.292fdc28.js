"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[4423],{3249:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>s,default:()=>h,frontMatter:()=>a,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"client/lua-api/field-api/encounter","title":"Encounter","description":"encounter:createspawner(packageid, rank)","source":"@site/docs/01-client/03-lua-api/03-field-api/05-encounter.md","sourceDirName":"01-client/03-lua-api/03-field-api","slug":"/client/lua-api/field-api/encounter","permalink":"/client/lua-api/field-api/encounter","draft":false,"unlisted":false,"editUrl":"https://github.com/Hub-OS/documentation-website/tree/master/docs/01-client/03-lua-api/03-field-api/05-encounter.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{},"sidebar":"clientSidebar","previous":{"title":"Movement","permalink":"/client/lua-api/field-api/movement"},"next":{"title":"Custom Tile State","permalink":"/client/lua-api/field-api/custom-tile-state"}}');var r=t(4848),l=t(8453);const a={},s="Encounter",c={},d=[{value:"<code>encounter:create_spawner(package_id, rank)</code>",id:"encountercreate_spawnerpackage_id-rank",level:3},{value:"<code>encounter:player_count()</code>",id:"encounterplayer_count",level:3},{value:"<code>encounter:spawn_player(player_index, col, row)</code>",id:"encounterspawn_playerplayer_index-col-row",level:3},{value:"<code>encounter:mark_spectator(player_index)</code>",id:"encountermark_spectatorplayer_index",level:3},{value:"<code>encounter:set_spectate_on_delete(bool?)</code>",id:"encounterset_spectate_on_deletebool",level:3},{value:"<code>encounter:set_background(texture_path, animation_path, vel_x?, vel_y?)</code>",id:"encounterset_backgroundtexture_path-animation_path-vel_x-vel_y",level:3},{value:"<code>encounter:set_panels(texture_paths, animation_path, tile_width, tile_height)</code>",id:"encounterset_panelstexture_paths-animation_path-tile_width-tile_height",level:3},{value:"<code>encounter:set_field_size(width, height)</code>",id:"encounterset_field_sizewidth-height",level:3},{value:"<code>encounter:set_music(path)</code>",id:"encounterset_musicpath",level:3},{value:"<code>encounter:field()</code>",id:"encounterfield",level:3},{value:"<code>encounter:enable_automatic_turn_end(enabled?)</code>",id:"encounterenable_automatic_turn_endenabled",level:3},{value:"<code>encounter:set_turn_limit(limit)</code>",id:"encounterset_turn_limitlimit",level:3},{value:"<code>encounter:enable_flipping(enable?, player_index?)</code>",id:"encounterenable_flippingenable-player_index",level:3},{value:"<code>encounter:enable_boss_battle(enabled?)</code>",id:"encounterenable_boss_battleenabled",level:3},{value:"<code>encounter:enable_scripted_scene_end()</code>",id:"encounterenable_scripted_scene_end",level:3},{value:"<code>encounter:enable_scripted_result()</code>",id:"encounterenable_scripted_result",level:3},{value:"<code>encounter:win()</code>",id:"encounterwin",level:3},{value:"<code>encounter:lose()</code>",id:"encounterlose",level:3},{value:"<code>encounter:end_scene()</code>",id:"encounterend_scene",level:3},{value:"<code>encounter:on_battle_end(function(won))</code>",id:"encounteron_battle_endfunctionwon",level:3},{value:"<code>encounter:send_to_server(data)</code>",id:"encountersend_to_serverdata",level:3},{value:"<code>encounter:on_server_message(function(data))</code>",id:"encounteron_server_messagefunctiondata",level:3},{value:"Spawner",id:"spawner",level:2},{value:"<code>spawner:spawn_at(col, row)</code>",id:"spawnerspawn_atcol-row",level:3},{value:"Mutator",id:"mutator",level:2},{value:"<code>mutator:mutate(function(entity))</code>",id:"mutatormutatefunctionentity",level:3}];function o(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",ul:"ul",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"encounter",children:"Encounter"})}),"\n",(0,r.jsx)(n.h3,{id:"encountercreate_spawnerpackage_id-rank",children:(0,r.jsx)(n.code,{children:"encounter:create_spawner(package_id, rank)"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"package_id"}),": string, the package id for a character package"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"rank"}),": ",(0,r.jsx)(n.a,{href:"/client/lua-api/entity-api/character#characterfrom_packagepackage_id-team-rank",children:"Rank"})]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["Returns a ",(0,r.jsx)(n.a,{href:"#spawner",children:"Spawner"})]}),"\n",(0,r.jsx)(n.h3,{id:"encounterplayer_count",children:(0,r.jsx)(n.code,{children:"encounter:player_count()"})}),"\n",(0,r.jsx)(n.p,{children:"Returns a number, the amount of players that will join the battle."}),"\n",(0,r.jsx)(n.h3,{id:"encounterspawn_playerplayer_index-col-row",children:(0,r.jsx)(n.code,{children:"encounter:spawn_player(player_index, col, row)"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"player_index"}),": number, starts at 0"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Sets the spawn position for this player."}),"\n",(0,r.jsx)(n.h3,{id:"encountermark_spectatorplayer_index",children:(0,r.jsx)(n.code,{children:"encounter:mark_spectator(player_index)"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"player_index"}),": number, starts at 0"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Marks the player as a spectator. Avoids creating an entity for this player (Mods from this player will still be loaded)."}),"\n",(0,r.jsx)(n.h3,{id:"encounterset_spectate_on_deletebool",children:(0,r.jsx)(n.code,{children:"encounter:set_spectate_on_delete(bool?)"})}),"\n",(0,r.jsx)(n.p,{children:"Converts players to spectators when deleted."}),"\n",(0,r.jsx)(n.h3,{id:"encounterset_backgroundtexture_path-animation_path-vel_x-vel_y",children:(0,r.jsx)(n.code,{children:"encounter:set_background(texture_path, animation_path, vel_x?, vel_y?)"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"vel_x"}),': if unset, uses the "VELOCITY" point on the first frame of the animation.']}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"vel_y"}),': if unset, uses the "VELOCITY" point on the first frame of the animation.']}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"encounterset_panelstexture_paths-animation_path-tile_width-tile_height",children:(0,r.jsx)(n.code,{children:"encounter:set_panels(texture_paths, animation_path, tile_width, tile_height)"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"texture_paths"}),": a list of path strings, expects a path for ",(0,r.jsx)(n.code,{children:"Team.Red"}),", ",(0,r.jsx)(n.code,{children:"Team.Blue"}),", and ",(0,r.jsx)(n.code,{children:"Team.Other"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"animation_path"}),": an animation file used by tiles, applies to all team textures."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"tile_width"}),": width used to resolve spacing."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"tile_height"}),": height used to resolve spacing."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Experimental. Replacement / removal is under consideration."}),"\n",(0,r.jsx)(n.h3,{id:"encounterset_field_sizewidth-height",children:(0,r.jsx)(n.code,{children:"encounter:set_field_size(width, height)"})}),"\n",(0,r.jsxs)(n.p,{children:["Resizes the field, remember to add two to each dimension to account for the invisible edge tiles (The default field size is 8x5). If the field is larger than the screen allows, the camera will adjust placement and zoom to fit all ",(0,r.jsx)(n.a,{href:"/client/lua-api/entity-api/character",children:"Characters"}),"."]}),"\n",(0,r.jsx)(n.p,{children:"Resets tile teams and states on the field."}),"\n",(0,r.jsx)(n.h3,{id:"encounterset_musicpath",children:(0,r.jsx)(n.code,{children:"encounter:set_music(path)"})}),"\n",(0,r.jsxs)(n.p,{children:["Sets the initial battle music. Use ",(0,r.jsx)(n.a,{href:"/client/lua-api/resource-api/resources#resourcesplay_musicpath-loops",children:"Resources.play_music()"})," to change the music in the middle of the battle"]}),"\n",(0,r.jsx)(n.h3,{id:"encounterfield",children:(0,r.jsx)(n.code,{children:"encounter:field()"})}),"\n",(0,r.jsxs)(n.p,{children:["Returns ",(0,r.jsx)(n.a,{href:"/client/lua-api/field-api/field",children:"Field"})]}),"\n",(0,r.jsx)(n.h3,{id:"encounterenable_automatic_turn_endenabled",children:(0,r.jsx)(n.code,{children:"encounter:enable_automatic_turn_end(enabled?)"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"enabled"}),": defaults to true."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Causes turns to end without needing the player to press the EndTurn button."}),"\n",(0,r.jsx)(n.h3,{id:"encounterset_turn_limitlimit",children:(0,r.jsx)(n.code,{children:"encounter:set_turn_limit(limit)"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"limit"}),": max number of turns players can take."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["If the ",(0,r.jsx)(n.code,{children:"limit"})," is hit, the battle will end as a failure."]}),"\n",(0,r.jsx)(n.h3,{id:"encounterenable_flippingenable-player_index",children:(0,r.jsx)(n.code,{children:"encounter:enable_flipping(enable?, player_index?)"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"enable"}),": defaults to true."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"player_index"}),": starts at 0, if unset applies to all players."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"When enabled, players can flip using the FaceLeft and FaceRight buttons."}),"\n",(0,r.jsx)(n.p,{children:"If this function is never called, it is automatically decided by checking for non team panels on the end row behind the player."}),"\n",(0,r.jsx)(n.h3,{id:"encounterenable_boss_battleenabled",children:(0,r.jsx)(n.code,{children:"encounter:enable_boss_battle(enabled?)"})}),"\n",(0,r.jsxs)(n.p,{children:["Affects the score in ",(0,r.jsx)(n.a,{href:"/server/lua-api/events#battle_results",children:"battle_results"}),"."]}),"\n",(0,r.jsx)(n.h3,{id:"encounterenable_scripted_scene_end",children:(0,r.jsx)(n.code,{children:"encounter:enable_scripted_scene_end()"})}),"\n",(0,r.jsx)(n.p,{children:"Disables the built-in battle result banner and prevents the scene from automatically ending."}),"\n",(0,r.jsx)(n.h3,{id:"encounterenable_scripted_result",children:(0,r.jsx)(n.code,{children:"encounter:enable_scripted_result()"})}),"\n",(0,r.jsx)(n.p,{children:"Disables the built-in win / loss detection."}),"\n",(0,r.jsx)(n.h3,{id:"encounterwin",children:(0,r.jsx)(n.code,{children:"encounter:win()"})}),"\n",(0,r.jsxs)(n.p,{children:["Marks the battle as a win for ",(0,r.jsx)(n.a,{href:"/server/lua-api/events#battle_results",children:"battle_results"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["Additionally ",(0,r.jsx)(n.a,{href:"#encounteron_battle_endfunctionwon",children:"ends the battle"}),", does not end the scene."]}),"\n",(0,r.jsx)(n.h3,{id:"encounterlose",children:(0,r.jsx)(n.code,{children:"encounter:lose()"})}),"\n",(0,r.jsxs)(n.p,{children:["Marks the battle as a loss for ",(0,r.jsx)(n.a,{href:"/server/lua-api/events#battle_results",children:"battle_results"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["Additionally ",(0,r.jsx)(n.a,{href:"#encounteron_battle_endfunctionwon",children:"ends the battle"}),", does not end the scene."]}),"\n",(0,r.jsx)(n.h3,{id:"encounterend_scene",children:(0,r.jsx)(n.code,{children:"encounter:end_scene()"})}),"\n",(0,r.jsx)(n.p,{children:"Signals the end of the scene, allowing the player to return to a server or previous menu."}),"\n",(0,r.jsxs)(n.p,{children:["Additionally ",(0,r.jsx)(n.a,{href:"#encounteron_battle_endfunctionwon",children:"ends the battle"})]}),"\n",(0,r.jsx)(n.h3,{id:"encounteron_battle_endfunctionwon",children:(0,r.jsx)(n.code,{children:"encounter:on_battle_end(function(won))"})}),"\n",(0,r.jsx)(n.p,{children:"Adds a listener for the battle end to handle results."}),"\n",(0,r.jsx)(n.h3,{id:"encountersend_to_serverdata",children:(0,r.jsx)(n.code,{children:"encounter:send_to_server(data)"})}),"\n",(0,r.jsxs)(n.p,{children:["Sends a message to the server that initiated this battle, which can be accessed on the server in the ",(0,r.jsx)(n.a,{href:"/server/lua-api/events#battle_message",children:"battle_message"})," event."]}),"\n",(0,r.jsx)(n.h3,{id:"encounteron_server_messagefunctiondata",children:(0,r.jsx)(n.code,{children:"encounter:on_server_message(function(data))"})}),"\n",(0,r.jsxs)(n.p,{children:["Receives a message sent from the server by ",(0,r.jsx)(n.a,{href:"/server/lua-api/players#netsend_battle_messagebattle_id-encounter_data",children:"Net.send_battle_message()"}),"."]}),"\n",(0,r.jsx)(n.h2,{id:"spawner",children:"Spawner"}),"\n",(0,r.jsx)(n.p,{children:"Spawns characters at the start of battle."}),"\n",(0,r.jsxs)(n.p,{children:["See ",(0,r.jsxs)(n.a,{href:"#encountercreate_spawnerpackage_id-rank",children:["encounter",":create_spawner","()"]})," for creating a spawner."]}),"\n",(0,r.jsx)(n.h3,{id:"spawnerspawn_atcol-row",children:(0,r.jsx)(n.code,{children:"spawner:spawn_at(col, row)"})}),"\n",(0,r.jsx)(n.p,{children:"Spawns the character at this position."}),"\n",(0,r.jsx)(n.p,{children:"The tile at this position decides facing direction and team."}),"\n",(0,r.jsxs)(n.p,{children:["Returns a ",(0,r.jsx)(n.a,{href:"#mutator",children:"Mutator"})]}),"\n",(0,r.jsx)(n.h2,{id:"mutator",children:"Mutator"}),"\n",(0,r.jsx)(n.p,{children:"Allows for modification of a spawned character. Usage is optional."}),"\n",(0,r.jsx)(n.h3,{id:"mutatormutatefunctionentity",children:(0,r.jsx)(n.code,{children:"mutator:mutate(function(entity))"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"entity"}),": ",(0,r.jsx)(n.a,{href:"/client/lua-api/entity-api/entity",children:"Entity"})]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>s});var i=t(6540);const r={},l=i.createContext(r);function a(e){const n=i.useContext(l);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),i.createElement(l.Provider,{value:n},e.children)}}}]);