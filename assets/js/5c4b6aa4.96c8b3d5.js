"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[8929],{5145:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>r});const i=JSON.parse('{"id":"client/lua-api/resource-api/animation","title":"Animation","description":"Animation.new(path?)","source":"@site/docs/01-client/03-lua-api/02-resource-api/02-animation.md","sourceDirName":"01-client/03-lua-api/02-resource-api","slug":"/client/lua-api/resource-api/animation","permalink":"/client/lua-api/resource-api/animation","draft":false,"unlisted":false,"editUrl":"https://github.com/Hub-OS/documentation-website/tree/master/docs/01-client/03-lua-api/02-resource-api/02-animation.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{},"sidebar":"clientSidebar","previous":{"title":"Resources","permalink":"/client/lua-api/resource-api/resources"},"next":{"title":"Sprite","permalink":"/client/lua-api/resource-api/sprite"}}');var t=a(4848),s=a(8453);const o={},l="Animation",c={},r=[{value:"<code>Animation.new(path?)</code>",id:"animationnewpath",level:3},{value:"<code>animation:copy_from(animation)</code>",id:"animationcopy_fromanimation",level:3},{value:"<code>animation:apply(sprite)</code>",id:"animationapplysprite",level:3},{value:"<code>animation:load(path)</code>",id:"animationloadpath",level:3},{value:"<code>animation:update()</code>",id:"animationupdate",level:3},{value:"<code>animation:sync_time(time)</code>",id:"animationsync_timetime",level:3},{value:"<code>animation:pause()</code>",id:"animationpause",level:3},{value:"<code>animation:resume()</code>",id:"animationresume",level:3},{value:"<code>animation:completed()</code>",id:"animationcompleted",level:3},{value:"<code>animation:has_state(state)</code>",id:"animationhas_statestate",level:3},{value:"<code>animation:state()</code>",id:"animationstate",level:3},{value:"<code>animation:states()</code>",id:"animationstates",level:3},{value:"<code>animation:set_state(state, frame_data?)</code>",id:"animationset_statestate-frame_data",level:3},{value:"<code>animation:has_point(name)</code>",id:"animationhas_pointname",level:3},{value:"<code>animation:get_point(name)</code>",id:"animationget_pointname",level:3},{value:"<code>animation:relative_point(name, origin_name?)</code>",id:"animationrelative_pointname-origin_name",level:3},{value:"<code>animation:set_playback(playback)</code>",id:"animationset_playbackplayback",level:3},{value:"<code>animation:on_complete(function())</code>",id:"animationon_completefunction",level:3},{value:"<code>animation:on_interrupt(function())</code>",id:"animationon_interruptfunction",level:3},{value:"<code>animation:on_frame(frame_index, function(), do_once?)</code>",id:"animationon_frameframe_index-function-do_once",level:3}];function d(e){const n={code:"code",h1:"h1",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"animation",children:"Animation"})}),"\n",(0,t.jsx)(n.h3,{id:"animationnewpath",children:(0,t.jsx)(n.code,{children:"Animation.new(path?)"})}),"\n",(0,t.jsx)(n.p,{children:"Returns a new Animation instance."}),"\n",(0,t.jsx)(n.h3,{id:"animationcopy_fromanimation",children:(0,t.jsx)(n.code,{children:"animation:copy_from(animation)"})}),"\n",(0,t.jsx)(n.p,{children:"Copies states and settings from the passed animation. Progress is reset."}),"\n",(0,t.jsxs)(n.p,{children:["Internally calls ",(0,t.jsx)(n.code,{children:"animation:apply()"})," unless the animation was created through ",(0,t.jsx)(n.code,{children:"Animation.new()"})]}),"\n",(0,t.jsx)(n.p,{children:"This function will call and clear interrupt callbacks."}),"\n",(0,t.jsx)(n.h3,{id:"animationapplysprite",children:(0,t.jsx)(n.code,{children:"animation:apply(sprite)"})}),"\n",(0,t.jsx)(n.p,{children:"Applies the current animation state to the sprite, updating the origin and bounds of the sprite."}),"\n",(0,t.jsx)(n.h3,{id:"animationloadpath",children:(0,t.jsx)(n.code,{children:"animation:load(path)"})}),"\n",(0,t.jsx)(n.p,{children:"Loads new states, clears the old states."}),"\n",(0,t.jsx)(n.p,{children:"Will attempt to retain settings and progress if the new animation has the same state as the active state."}),"\n",(0,t.jsx)(n.p,{children:"If the animation has not completed and retaining state fails, this function will call and clear interrupt callbacks."}),"\n",(0,t.jsx)(n.h3,{id:"animationupdate",children:(0,t.jsx)(n.code,{children:"animation:update()"})}),"\n",(0,t.jsx)(n.p,{children:"Advances animation progress by 1f or ~0.1666s. Ignored if the animation is paused."}),"\n",(0,t.jsxs)(n.p,{children:["Internally calls ",(0,t.jsx)(n.code,{children:"animation:apply()"})," unless the animation was created through ",(0,t.jsx)(n.code,{children:"Animation.new()"})]}),"\n",(0,t.jsxs)(n.p,{children:["Automatically called unless the animation was created through ",(0,t.jsx)(n.code,{children:"Animation.new()"})]}),"\n",(0,t.jsx)(n.h3,{id:"animationsync_timetime",children:(0,t.jsx)(n.code,{children:"animation:sync_time(time)"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"time"}),": number, represents game frames"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["Updates the animation as if it has only played for ",(0,t.jsx)(n.code,{children:"time"}),". Using the same time will freeze the animation, decreasing time will reverse the animation."]}),"\n",(0,t.jsx)(n.h3,{id:"animationpause",children:(0,t.jsx)(n.code,{children:"animation:pause()"})}),"\n",(0,t.jsxs)(n.p,{children:["Causes ",(0,t.jsx)(n.code,{children:"animation:update()"})," calls (including automatic calls) to be ignored."]}),"\n",(0,t.jsx)(n.h3,{id:"animationresume",children:(0,t.jsx)(n.code,{children:"animation:resume()"})}),"\n",(0,t.jsx)(n.p,{children:"Unpauses the animation."}),"\n",(0,t.jsx)(n.h3,{id:"animationcompleted",children:(0,t.jsx)(n.code,{children:"animation:completed()"})}),"\n",(0,t.jsx)(n.p,{children:"Returns true if the animation is complete."}),"\n",(0,t.jsx)(n.h3,{id:"animationhas_statestate",children:(0,t.jsx)(n.code,{children:"animation:has_state(state)"})}),"\n",(0,t.jsx)(n.p,{children:"Returns true if the state exists."}),"\n",(0,t.jsx)(n.h3,{id:"animationstate",children:(0,t.jsx)(n.code,{children:"animation:state()"})}),"\n",(0,t.jsx)(n.p,{children:"Returns the name of the active state."}),"\n",(0,t.jsx)(n.h3,{id:"animationstates",children:(0,t.jsx)(n.code,{children:"animation:states()"})}),"\n",(0,t.jsx)(n.p,{children:"Returns a list of available state names."}),"\n",(0,t.jsx)(n.h3,{id:"animationset_statestate-frame_data",children:(0,t.jsx)(n.code,{children:"animation:set_state(state, frame_data?)"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"frame_data"})," a list of frame index and duration pairs.","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["When provided, the animation will remap frames and durations to match until the next ",(0,t.jsx)(n.code,{children:"set_state"})," call."]}),"\n",(0,t.jsx)(n.li,{children:"Frame index starts at 1"}),"\n",(0,t.jsx)(n.li,{children:"Duration is in game frames (60 per second)."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Changes the active state, resets animation progress and settings."}),"\n",(0,t.jsx)(n.p,{children:"This function will call and clear interrupt callbacks."}),"\n",(0,t.jsxs)(n.p,{children:["Internally calls ",(0,t.jsx)(n.code,{children:"animation:apply()"})," unless the animation was created through ",(0,t.jsx)(n.code,{children:"Animation.new()"})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:'-- modified example from the built-in buster.lua file\n\nlocal frame_data = { { 1, 1 }, { 2, 2 }, { 3, 2 }, { 1, 1 } }\n\naction:override_animation_frames(frame_data)\n\n-- setup buster attachment\nlocal buster_attachment = action:add_attachment("BUSTER")\n\nlocal buster_sprite = buster_attachment:sprite()\nbuster_sprite:set_texture(user:texture())\nbuster_sprite:set_layer(-2)\nbuster_sprite:use_root_shader()\n\nlocal buster_animation = buster_attachment:animation()\nbuster_animation:copy_from(user:animation())\n\n-- relevant\nbuster_animation:set_state("BUSTER", frame_data)\n'})}),"\n",(0,t.jsx)(n.h3,{id:"animationhas_pointname",children:(0,t.jsx)(n.code,{children:"animation:has_point(name)"})}),"\n",(0,t.jsx)(n.p,{children:"Returns true if the current animation frame has a point with this name."}),"\n",(0,t.jsx)(n.h3,{id:"animationget_pointname",children:(0,t.jsx)(n.code,{children:"animation:get_point(name)"})}),"\n",(0,t.jsxs)(n.p,{children:["Returns ",(0,t.jsx)(n.code,{children:"{ x: number, y: number }"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"animationrelative_pointname-origin_name",children:(0,t.jsx)(n.code,{children:"animation:relative_point(name, origin_name?)"})}),"\n",(0,t.jsx)(n.p,{children:"Calculates where a point is relative to the origin."}),"\n",(0,t.jsxs)(n.p,{children:["Returns ",(0,t.jsx)(n.code,{children:"{ x: number, y: number }"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"animationset_playbackplayback",children:(0,t.jsx)(n.code,{children:"animation:set_playback(playback)"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"playback"}),":","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"Playback.Once"})," stops when the animation is completed."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"Playback.Loop"})," restarts the animation when completed."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"Playback.Bounce"})," when the animation completes playing forward it will play again reversed and cycle."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"Playback.Reverse"})," same as ",(0,t.jsx)(n.code,{children:"Playback.Once"})," but reversed.","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Currently does not start the animation on the last frame."}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:'animation:set_state("example")\nanimation:set_playback(Playback.Loop)\n'})}),"\n",(0,t.jsx)(n.h3,{id:"animationon_completefunction",children:(0,t.jsx)(n.code,{children:"animation:on_complete(function())"})}),"\n",(0,t.jsx)(n.p,{children:'Adds a function to be called when the animation "completes". The callback will no longer be called when the state is changed.'}),"\n",(0,t.jsx)(n.p,{children:"Completion condition differs depending on playback:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"Playback.Once"})," when the last frame completes."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"Playback.Loop"})," when the last frame completes."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"Playback.Bounce"})," when the first frame completes when reversed."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"Playback.Reverse"})," when the first frame completes."]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"animationon_interruptfunction",children:(0,t.jsx)(n.code,{children:"animation:on_interrupt(function())"})}),"\n",(0,t.jsx)(n.p,{children:"Adds a function to be called when the state changes. The callback will no longer be called after this occurs."}),"\n",(0,t.jsx)(n.h3,{id:"animationon_frameframe_index-function-do_once",children:(0,t.jsx)(n.code,{children:"animation:on_frame(frame_index, function(), do_once?)"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"frame_index"})," starts at 1"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"do_once"})," when true, the callback is deleted."]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["Calls the callback when the frame changes during an update. If the ",(0,t.jsx)(n.code,{children:"frame_index"})," is 1 and the state was just set, it will be called next update."]}),"\n",(0,t.jsx)(n.p,{children:"The callback will no longer be called when the state is changed."})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,n,a)=>{a.d(n,{R:()=>o,x:()=>l});var i=a(6540);const t={},s=i.createContext(t);function o(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);