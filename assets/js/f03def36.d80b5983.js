"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[7634],{8453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>l});var i=t(6540);const c={},a=i.createContext(c);function o(e){const n=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:o(e.components),i.createElement(a.Provider,{value:n},e.children)}},8526:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>r,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>s});const i=JSON.parse('{"id":"client/lua-api/attack-api/action","title":"Action","description":"While actions execute, their owners will stop auto reserving tiles.","source":"@site/docs/01-client/03-lua-api/04-attack-api/01-action.md","sourceDirName":"01-client/03-lua-api/04-attack-api","slug":"/client/lua-api/attack-api/action","permalink":"/client/lua-api/attack-api/action","draft":false,"unlisted":false,"editUrl":"https://github.com/Hub-OS/documentation-website/tree/master/docs/01-client/03-lua-api/04-attack-api/01-action.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{},"sidebar":"clientSidebar","previous":{"title":"Custom Tile State","permalink":"/client/lua-api/field-api/custom-tile-state"},"next":{"title":"HitProps","permalink":"/client/lua-api/attack-api/hit-props"}}');var c=t(4848),a=t(8453);const o={},l="Action",r={},s=[{value:"<code>Action.new(entity, state?)</code>",id:"actionnewentity-state",level:3},{value:"<code>Action.from_card(entity, card_properties)</code>",id:"actionfrom_cardentity-card_properties",level:3},{value:"<code>action:owner()</code>",id:"actionowner",level:3},{value:"<code>action:set_lockout(lockout)</code>",id:"actionset_lockoutlockout",level:3},{value:"<code>action:allow_auto_tile_reservation(bool?)</code>",id:"actionallow_auto_tile_reservationbool",level:3},{value:"<code>action:create_step()</code>",id:"actioncreate_step",level:3},{value:"<code>action:create_attachment(point_name)</code>",id:"actioncreate_attachmentpoint_name",level:3},{value:"<code>action:override_animation_frames(frame_data)</code>",id:"actionoverride_animation_framesframe_data",level:3},{value:"<code>action:add_anim_action(frame_index, callback)</code>",id:"actionadd_anim_actionframe_index-callback",level:3},{value:"<code>action:end_action()</code>",id:"actionend_action",level:3},{value:"<code>action:copy_card_properties()</code>",id:"actioncopy_card_properties",level:3},{value:"<code>action:set_card_properties(card_properties)</code>",id:"actionset_card_propertiescard_properties",level:3},{value:"<code>action.on_execute_func = function(self, owner)</code>",id:"actionon_execute_func--functionself-owner",level:3},{value:"<code>action.on_update_func = function(self)</code>",id:"actionon_update_func--functionself",level:3},{value:"<code>action.on_animation_end_func = function(self)</code>",id:"actionon_animation_end_func--functionself",level:3},{value:"<code>action.on_action_end_func = function(self)</code>",id:"actionon_action_end_func--functionself",level:3},{value:"<code>action.can_move_to_func = function(tile): boolean</code>",id:"actioncan_move_to_func--functiontile-boolean",level:3},{value:"Attachment",id:"attachment",level:2},{value:"<code>attachment:create_attachment(point_name)</code>",id:"attachmentcreate_attachmentpoint_name",level:3},{value:"<code>attachment:sprite()</code>",id:"attachmentsprite",level:3},{value:"<code>attachment:animation()</code>",id:"attachmentanimation",level:3},{value:"ActionLockout",id:"actionlockout",level:2},{value:"<code>ActionLockout.new_animation()</code>",id:"actionlockoutnew_animation",level:3},{value:"<code>ActionLockout.new_sequence()</code>",id:"actionlockoutnew_sequence",level:3},{value:"<code>ActionLockout.new_async(duration)</code>",id:"actionlockoutnew_asyncduration",level:3},{value:"ActionStep",id:"actionstep",level:2},{value:"<code>action_step:complete_step()</code>",id:"action_stepcomplete_step",level:3},{value:"<code>action_step.on_update_func = function(self)</code>",id:"action_stepon_update_func--functionself",level:3},{value:"Buster",id:"buster",level:2},{value:"<code>Buster.new(player, charged, damage)</code>",id:"busternewplayer-charged-damage",level:3}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",ul:"ul",...(0,a.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(n.header,{children:(0,c.jsx)(n.h1,{id:"action",children:"Action"})}),"\n",(0,c.jsx)(n.p,{children:"While actions execute, their owners will stop auto reserving tiles."}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.a,{href:"/client/lua-api/entity-api/player",children:"Players"}),", ",(0,c.jsx)(n.a,{href:"/client/lua-api/entity-api/character",children:"Characters"}),", and ",(0,c.jsx)(n.a,{href:"/client/lua-api/entity-api/obstacle",children:"Obstacles"})," automatically reserve tiles outside of executing actions."]}),"\n",(0,c.jsx)(n.h3,{id:"actionnewentity-state",children:(0,c.jsx)(n.code,{children:"Action.new(entity, state?)"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"entity"}),": the ",(0,c.jsx)(n.a,{href:"/client/lua-api/entity-api/entity",children:"Entity"})," to tie the action to."]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"state"}),": string, the animation state to play when the action executes."]}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:"Returns a new Action."}),"\n",(0,c.jsx)(n.h3,{id:"actionfrom_cardentity-card_properties",children:(0,c.jsx)(n.code,{children:"Action.from_card(entity, card_properties)"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"entity"}),": the ",(0,c.jsx)(n.a,{href:"/client/lua-api/entity-api/entity",children:"Entity"})," to tie the action to."]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"card_properties"}),": ",(0,c.jsx)(n.a,{href:"/client/lua-api/attack-api/cards#cardproperties",children:"CardProperties"})]}),"\n"]}),"\n",(0,c.jsxs)(n.p,{children:["Returns Action or ",(0,c.jsx)(n.code,{children:"nil"})]}),"\n",(0,c.jsx)(n.h3,{id:"actionowner",children:(0,c.jsx)(n.code,{children:"action:owner()"})}),"\n",(0,c.jsxs)(n.p,{children:["Returns the ",(0,c.jsx)(n.a,{href:"/client/lua-api/entity-api/entity",children:"Entity"})," tied to this action"]}),"\n",(0,c.jsx)(n.h3,{id:"actionset_lockoutlockout",children:(0,c.jsx)(n.code,{children:"action:set_lockout(lockout)"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"lockout"}),": ",(0,c.jsx)(n.a,{href:"#actionlockout",children:"ActionLockout"})]}),"\n"]}),"\n",(0,c.jsx)(n.h3,{id:"actionallow_auto_tile_reservationbool",children:(0,c.jsx)(n.code,{children:"action:allow_auto_tile_reservation(bool?)"})}),"\n",(0,c.jsx)(n.p,{children:"By default, actions prevent entities from creating tile reservations on movement."}),"\n",(0,c.jsxs)(n.p,{children:["Calling this function with ",(0,c.jsx)(n.code,{children:"true"})," or ",(0,c.jsx)(n.code,{children:"nil"})," will allow the action's owner to reserve entered tiles and unreserve left tiles.\nThis only matters for entities that automatically reserve tiles by default, such as Characters and Obstacles."]}),"\n",(0,c.jsx)(n.h3,{id:"actioncreate_step",children:(0,c.jsx)(n.code,{children:"action:create_step()"})}),"\n",(0,c.jsxs)(n.p,{children:["Returns a new ",(0,c.jsx)(n.a,{href:"#actionstep",children:"ActionStep"})]}),"\n",(0,c.jsx)(n.h3,{id:"actioncreate_attachmentpoint_name",children:(0,c.jsx)(n.code,{children:"action:create_attachment(point_name)"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"point_name"}),": string, name of a point in the animation to anchor the attachment to"]}),"\n"]}),"\n",(0,c.jsxs)(n.p,{children:["Returns ",(0,c.jsx)(n.a,{href:"#attachment",children:"Attachment"})]}),"\n",(0,c.jsx)(n.h3,{id:"actionoverride_animation_framesframe_data",children:(0,c.jsx)(n.code,{children:"action:override_animation_frames(frame_data)"})}),"\n",(0,c.jsxs)(n.p,{children:["See ",(0,c.jsxs)(n.a,{href:"/client/lua-api/resource-api/animation#animationset_statestate-frame_data",children:["animation",":set_state","()"]})]}),"\n",(0,c.jsx)(n.h3,{id:"actionadd_anim_actionframe_index-callback",children:(0,c.jsx)(n.code,{children:"action:add_anim_action(frame_index, callback)"})}),"\n",(0,c.jsxs)(n.p,{children:["Same as calling ",(0,c.jsx)(n.code,{children:"action:owner():on_frame(frame_index, callback)"})," within ",(0,c.jsx)(n.a,{href:"#actionon_execute_func--functionself-owner",children:"action.on_execute_func"})]}),"\n",(0,c.jsxs)(n.p,{children:["See ",(0,c.jsxs)(n.a,{href:"/client/lua-api/resource-api/animation#animationon_frameframe_index-function-do_once",children:["animation",":on_frame","()"]})]}),"\n",(0,c.jsx)(n.h3,{id:"actionend_action",children:(0,c.jsx)(n.code,{children:"action:end_action()"})}),"\n",(0,c.jsxs)(n.p,{children:["Calls ",(0,c.jsx)(n.a,{href:"#actionon_action_end_func--functionself",children:"action.on_action_end_func"})]}),"\n",(0,c.jsx)(n.p,{children:"Stops execution and deletes the action."}),"\n",(0,c.jsx)(n.h3,{id:"actioncopy_card_properties",children:(0,c.jsx)(n.code,{children:"action:copy_card_properties()"})}),"\n",(0,c.jsx)(n.p,{children:"Returns a copy of the action's card properties."}),"\n",(0,c.jsx)(n.p,{children:"Experimental. Replacement / removal is under consideration."}),"\n",(0,c.jsx)(n.h3,{id:"actionset_card_propertiescard_properties",children:(0,c.jsx)(n.code,{children:"action:set_card_properties(card_properties)"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"card_properties"}),": ",(0,c.jsx)(n.a,{href:"/client/lua-api/attack-api/cards#cardproperties",children:"CardProperties"})]}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:"Sets the the action's card properties, will be overwritten when queued if the action is tied to a card."}),"\n",(0,c.jsx)(n.p,{children:"Experimental. Replacement / removal is under consideration."}),"\n",(0,c.jsx)(n.h3,{id:"actionon_execute_func--functionself-owner",children:(0,c.jsx)(n.code,{children:"action.on_execute_func = function(self, owner)"})}),"\n",(0,c.jsx)(n.p,{children:"Called when the action begins execution."}),"\n",(0,c.jsx)(n.h3,{id:"actionon_update_func--functionself",children:(0,c.jsx)(n.code,{children:"action.on_update_func = function(self)"})}),"\n",(0,c.jsx)(n.p,{children:"Called while the action is executing."}),"\n",(0,c.jsx)(n.h3,{id:"actionon_animation_end_func--functionself",children:(0,c.jsx)(n.code,{children:"action.on_animation_end_func = function(self)"})}),"\n",(0,c.jsx)(n.p,{children:"Called when the action's animation ends."}),"\n",(0,c.jsx)(n.h3,{id:"actionon_action_end_func--functionself",children:(0,c.jsx)(n.code,{children:"action.on_action_end_func = function(self)"})}),"\n",(0,c.jsx)(n.p,{children:"Called when the action ends execution, including cancellation without execution."}),"\n",(0,c.jsx)(n.h3,{id:"actioncan_move_to_func--functiontile-boolean",children:(0,c.jsx)(n.code,{children:"action.can_move_to_func = function(tile): boolean"})}),"\n",(0,c.jsxs)(n.p,{children:["Override's the owner's ",(0,c.jsx)(n.a,{href:"/client/lua-api/entity-api/entity/#entitycan_move_to_func--functiontile-boolean",children:"can_move_to_func"})," while executing."]}),"\n",(0,c.jsx)(n.p,{children:"Ignored on async actions when the entity regains control."}),"\n",(0,c.jsx)(n.h2,{id:"attachment",children:"Attachment"}),"\n",(0,c.jsx)(n.h3,{id:"attachmentcreate_attachmentpoint_name",children:(0,c.jsx)(n.code,{children:"attachment:create_attachment(point_name)"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"point_name"}),": string, name of a point in this attachment's animation to anchor the new attachment to"]}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:"Returns an Attachment"}),"\n",(0,c.jsx)(n.h3,{id:"attachmentsprite",children:(0,c.jsx)(n.code,{children:"attachment:sprite()"})}),"\n",(0,c.jsxs)(n.p,{children:["Returns a reference to the attachment's ",(0,c.jsx)(n.a,{href:"/client/lua-api/resource-api/sprite",children:"Sprite"})]}),"\n",(0,c.jsx)(n.h3,{id:"attachmentanimation",children:(0,c.jsx)(n.code,{children:"attachment:animation()"})}),"\n",(0,c.jsxs)(n.p,{children:["Returns a reference to the attachment's ",(0,c.jsx)(n.a,{href:"/client/lua-api/resource-api/animation",children:"Animation"})]}),"\n",(0,c.jsx)(n.h2,{id:"actionlockout",children:"ActionLockout"}),"\n",(0,c.jsx)(n.p,{children:"Controls when Actions complete."}),"\n",(0,c.jsx)(n.h3,{id:"actionlockoutnew_animation",children:(0,c.jsx)(n.code,{children:"ActionLockout.new_animation()"})}),"\n",(0,c.jsx)(n.p,{children:"Returns ActionLockout."}),"\n",(0,c.jsx)(n.p,{children:"Action completes when the animation ends."}),"\n",(0,c.jsx)(n.h3,{id:"actionlockoutnew_sequence",children:(0,c.jsx)(n.code,{children:"ActionLockout.new_sequence()"})}),"\n",(0,c.jsx)(n.p,{children:"Returns ActionLockout."}),"\n",(0,c.jsxs)(n.p,{children:["Action completes when the action runs out of ",(0,c.jsx)(n.a,{href:"#actionstep",children:"ActionSteps"})," to execute"]}),"\n",(0,c.jsx)(n.h3,{id:"actionlockoutnew_asyncduration",children:(0,c.jsx)(n.code,{children:"ActionLockout.new_async(duration)"})}),"\n",(0,c.jsx)(n.p,{children:"Returns ActionLockout."}),"\n",(0,c.jsx)(n.p,{children:"When the animation ends, entities regain movement control. Attacks must wait for the duration to end."}),"\n",(0,c.jsx)(n.h2,{id:"actionstep",children:"ActionStep"}),"\n",(0,c.jsx)(n.h3,{id:"action_stepcomplete_step",children:(0,c.jsx)(n.code,{children:"action_step:complete_step()"})}),"\n",(0,c.jsx)(n.p,{children:"Marks the step as complete."}),"\n",(0,c.jsx)(n.h3,{id:"action_stepon_update_func--functionself",children:(0,c.jsx)(n.code,{children:"action_step.on_update_func = function(self)"})}),"\n",(0,c.jsx)(n.p,{children:"Called every tick while the associated action is active if this step is not marked as complete, and there are no steps created before this step that haven't been marked as complete."}),"\n",(0,c.jsx)(n.h2,{id:"buster",children:"Buster"}),"\n",(0,c.jsx)(n.h3,{id:"busternewplayer-charged-damage",children:(0,c.jsx)(n.code,{children:"Buster.new(player, charged, damage)"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"player"}),": ",(0,c.jsx)(n.a,{href:"/client/lua-api/entity-api/player",children:"Player"})]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"charged"}),": bool, affects hit artifact"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"damage"}),": number"]}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:"Returns a new Action"})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,c.jsx)(n,{...e,children:(0,c.jsx)(d,{...e})}):d(e)}}}]);